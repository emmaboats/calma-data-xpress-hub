CREATE TABLE IF NOT EXISTS users (
  user_id SERIAL PRIMARY KEY,
  name VARCHAR(120),
  email VARCHAR(255) UNIQUE NOT NULL,
  phone VARCHAR(30),
  password_hash TEXT NOT NULL,
  is_admin BOOLEAN DEFAULT FALSE,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS products (
  product_id SERIAL PRIMARY KEY,
  name VARCHAR(200) NOT NULL,
  sku VARCHAR(100),
  price NUMERIC(10,2) NOT NULL,
  type VARCHAR(50) NOT NULL CHECK (type IN ('data_bundle','voucher')),
  network VARCHAR(50),
  size VARCHAR(50),
  active BOOLEAN DEFAULT TRUE,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS orders (
  order_id SERIAL PRIMARY KEY,
  user_id INT REFERENCES users(user_id) ON DELETE SET NULL,
  product_id INT REFERENCES products(product_id),
  quantity INT DEFAULT 1,
  total_amount NUMERIC(12,2) NOT NULL,
  status VARCHAR(50) DEFAULT 'pending',
  phone VARCHAR(30),
  email VARCHAR(255),
  transaction_ref VARCHAR(200),
  payment_gateway VARCHAR(50),
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- seed products
INSERT INTO products (name, price, description) VALUES
('1GB Data Bundle', 6.00, '1GB data bundle'),
('2GB Data Bundle', 12.00, '2GB data bundle'),
('3GB Data Bundle', 18.00, '3GB data bundle'),
('4GB Data Bundle', 24.00, '4GB data bundle'),
('5GB Data Bundle', 30.00, '5GB data bundle'),
('6GB Data Bundle', 36.00, '6GB data bundle'),
('7GB Data Bundle', 42.00, '7GB data bundle'),
('8GB Data Bundle', 48.00, '8GB data bundle'),
('9GB Data Bundle', 54.00, '9GB data bundle'),
('10GB Data Bundle', 60.00, '10GB data bundle'),
('11GB Data Bundle', 66.00, '11GB data bundle'),
('12GB Data Bundle', 72.00, '12GB data bundle'),
('13GB Data Bundle', 78.00, '13GB data bundle'),
('14GB Data Bundle', 84.00, '14GB data bundle'),
('15GB Data Bundle', 90.00, '15GB data bundle'),
('16GB Data Bundle', 96.00, '16GB data bundle'),
('17GB Data Bundle', 102.00, '17GB data bundle'),
('18GB Data Bundle', 108.00, '18GB data bundle'),
('19GB Data Bundle', 114.00, '19GB data bundle'),
('20GB Data Bundle', 120.00, '20GB data bundle'),
('21GB Data Bundle', 126.00, '21GB data bundle'),
('22GB Data Bundle', 132.00, '22GB data bundle'),
('23GB Data Bundle', 138.00, '23GB data bundle'),
('24GB Data Bundle', 144.00, '24GB data bundle'),
('25GB Data Bundle', 150.00, '25GB data bundle'),
('26GB Data Bundle', 156.00, '26GB data bundle'),
('27GB Data Bundle', 162.00, '27GB data bundle'),
('28GB Data Bundle', 168.00, '28GB data bundle'),
('29GB Data Bundle', 174.00, '29GB data bundle'),
('30GB Data Bundle', 180.00, '30GB data bundle'),
('31GB Data Bundle', 186.00, '31GB data bundle'),
('32GB Data Bundle', 192.00, '32GB data bundle'),
('33GB Data Bundle', 198.00, '33GB data bundle'),
('34GB Data Bundle', 204.00, '34GB data bundle'),
('35GB Data Bundle', 210.00, '35GB data bundle'),
('36GB Data Bundle', 216.00, '36GB data bundle'),
('37GB Data Bundle', 222.00, '37GB data bundle'),
('38GB Data Bundle', 228.00, '38GB data bundle'),
('39GB Data Bundle', 234.00, '39GB data bundle'),
('40GB Data Bundle', 240.00, '40GB data bundle'),
('41GB Data Bundle', 246.00, '41GB data bundle'),
('42GB Data Bundle', 252.00, '42GB data bundle'),
('43GB Data Bundle', 258.00, '43GB data bundle'),
('44GB Data Bundle', 264.00, '44GB data bundle'),
('45GB Data Bundle', 270.00, '45GB data bundle'),
('46GB Data Bundle', 276.00, '46GB data bundle'),
('47GB Data Bundle', 282.00, '47GB data bundle'),
('48GB Data Bundle', 288.00, '48GB data bundle'),
('49GB Data Bundle', 294.00, '49GB data bundle'),
('50GB Data Bundle', 300.00, '50GB data bundle');
